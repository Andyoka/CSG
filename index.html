<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Diagnosa Data Cold Storage</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1a1a1a; color: #0f0; line-height: 1.5; }
        .box { border: 1px solid #333; padding: 15px; border-radius: 8px; background: #000; overflow-x: auto; }
        .error { color: #ff4757; font-weight: bold; }
        .success { color: #2ed573; font-weight: bold; }
    </style>
</head>
<body>

    <h2>üîç Diagnosa Data Google Sheets</h2>
    <div id="status">Menghubungkan ke Web App...</div>
    <hr>
    <h3>Isi 3 Baris Terakhir dari Sheet Anda:</h3>
    <div id="data-view" class="box">Menunggu data...</div>

<script>
    // GANTI URL INI DENGAN URL DEPLOYMENT TERBARU ANDA
    const API_URL = "https://script.google.com/macros/s/AKfycbyqvAX34sz4DbW3Y_-3cZ6pVa1J3521_S0TM-gt_lcUTSh3OI1ntNLZdq18YECbRR73AQ/exec";

    async function checkData() {
        const status = document.getElementById('status');
        const view = document.getElementById('data-view');

        try {
            const res = await fetch(API_URL);
            const data = await res.json();

            if (!data || data.length === 0) {
                status.innerHTML = "<span class='error'>GAGAL: Server merespon, tapi datanya KOSONG [].</span>";
                return;
            }

            status.innerHTML = "<span class='success'>BERHASIL: Terkoneksi! Total " + data.length + " baris ditemukan.</span>";
            
            // Ambil 3 baris terakhir untuk dicek strukturnya
            const sample = data.slice(-3);
            view.innerText = JSON.stringify(sample, null, 2);

        } catch (e) {
            status.innerHTML = "<span class='error'>ERROR KONEKSI: " + e.message + "</span><br><br>" +
                               "1. Pastikan URL sudah benar.<br>" +
                               "2. Pastikan Deployment di Google Script diatur ke 'Anyone'.";
        }
    }

    checkData();
</script>
</body>
</html>