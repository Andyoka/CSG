<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Produksi 1 - Cold Storage</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        #sidebar { transition: all 0.3s ease-in-out; }
        .sidebar-closed { transform: translateX(-100%); }
        .main-content { transition: margin-left 0.3s ease-in-out; }
        .text-neon-green { color: #4ade80; }
        .bg-neon-green { background-color: #4ade80; }
        .border-neon-green { border-color: #4ade80; }
        
        /* Smooth transition for iframe */
        #sheetFrame { transition: opacity 0.3s ease; }
    </style>
</head>
<body class="bg-gray-100 font-sans overflow-x-hidden">

    <aside id="sidebar" class="fixed top-0 left-0 h-screen w-56 bg-[#1e293b] text-white z-50 shadow-2xl">
        <div class="p-6">
            <div class="border-2 border-neon-green rounded-md py-1 px-2 text-center">
                <span class="text-sm font-black uppercase tracking-tighter text-neon-green">PRODUKSI 1</span>
            </div>
        </div>
        <nav class="mt-4 px-2">
            <a href="index.html" class="flex items-center py-2 px-4 mb-1 hover:bg-slate-700 transition rounded-md text-gray-400 hover:text-white">
                <span class="mr-3 text-sm">üè†</span> Home
            </a>
            <a href="cs.html" class="flex items-center py-2 px-4 mb-1 bg-neon-green text-black font-bold rounded-md shadow-lg">
                <span class="mr-3 text-sm">‚ùÑÔ∏è</span> Cold Storage
            </a>
            <a href="fj.html" class="flex items-center py-2 px-4 mb-1 hover:bg-slate-700 transition rounded-md text-gray-400 hover:text-white">
                <span class="mr-3 text-sm">ü•§</span> Fish Juice
            </a>
            <a href="fm.html" class="flex items-center py-2 px-4 mb-1 hover:bg-slate-700 transition rounded-md text-gray-400 hover:text-white">
                <span class="mr-3 text-sm">üêü</span> Fish Meal
            </a>
            <a href="rm.html" class="flex items-center py-2 px-4 mb-1 hover:bg-slate-700 transition rounded-md text-gray-400 hover:text-white">
                <span class="mr-3 text-sm">üì¶</span> Raw Material
            </a>
        </nav>
    </aside>

    <main id="mainContent" class="ml-56 p-4 main-content">
        <header class="flex justify-between items-center mb-6 bg-[#1e293b] text-white p-3 rounded-lg shadow-md border-l-4 border-neon-green">
            <div class="flex items-center">
                <button onclick="toggleSidebar()" class="bg-slate-700 p-2 rounded mr-4 hover:bg-slate-600 transition">
                    <span class="text-xs">‚ò∞ Menu</span>
                </button>
                <div>
                    <h1 class="text-xl font-bold inline-block">Dashboard Produksi 1</h1>
                    <span class="ml-2 text-neon-green font-bold uppercase tracking-widest text-sm">Cold Storage</span>
                </div>
            </div>
            <div class="flex items-center gap-3">
                <div id="syncStatus" class="hidden md:flex items-center gap-2 text-[10px] text-gray-400 bg-slate-800 px-3 py-1 rounded">
                    <span class="w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"></span>
                    Live Sync
                </div>
            </div>
        </header>

        <section class="bg-white rounded-xl shadow-xl border border-gray-200 overflow-hidden">
            <div class="bg-slate-800 p-3 flex justify-between items-center border-b border-slate-700">
                <h2 class="text-white font-bold text-sm flex items-center gap-2">
                    üì¶ Laporan Mingguan Terintegrasi
                </h2>
                <button onclick="forceRefresh()" class="bg-neon-green hover:bg-green-400 text-black px-3 py-1 rounded text-[10px] font-black transition transform active:scale-95 shadow-md">
                    üîÑ UPDATE DATA SEKARANG
                </button>
            </div>
            
            <div class="w-full bg-white relative">
                <iframe 
                    id="sheetFrame"
                    src="https://docs.google.com/spreadsheets/d/e/ID_SHEET_ANDA/pubhtml?widget=true&headers=false&chrome=false" 
                    class="w-full h-[650px] border-none">
                </iframe>
            </div>
        </section>

        <div class="mt-4 flex flex-col md:flex-row justify-between items-center gap-4 bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
            <div class="text-[10px] text-gray-500 italic">
                *Pilih tab minggu (W07, W08, dst) di bagian bawah tabel. Jika data baru belum muncul, klik tombol hijau di atas.
            </div>
            <div class="text-[10px] font-mono text-slate-400">
                Last Manual Sync: <span id="lastSync">Never</span>
            </div>
        </div>
    </main>

    <script>
        // Pastikan Anda mengisi ID Sheet Anda di sini
        const SHEET_ID = "2PACX-1vRQ6OPRqsuPRmTvAgsJNrU1ISOZ4x-0r1WSmpziuRNdecq42VVxgqferykNrUjJrB-KPWbt_NxgkpFk";

        // Fungsi Sidebar
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            sidebar.classList.toggle('sidebar-closed');
            mainContent.style.marginLeft = sidebar.classList.contains('sidebar-closed') ? "0" : "14rem";
        }

        // Fungsi Paksa Refresh (Bypass Cache)
        function forceRefresh() {
            const frame = document.getElementById('sheetFrame');
            const timeSpan = document.getElementById('lastSync');
            
            // Efek loading sederhana
            frame.style.opacity = "0.3";
            
            // Tambahkan Timestamp agar browser tidak ambil data lama
            const freshSrc = `https://docs.google.com/spreadsheets/d/e/${SHEET_ID}/pubhtml?widget=true&headers=false&chrome=false&t=${new Date().getTime()}`;
            
            frame.src = freshSrc;
            
            // Kembalikan opacity setelah sedikit jeda
            setTimeout(() => {
                frame.style.opacity = "1";
                const now = new Date();
                timeSpan.innerText = now.getHours() + ":" + now.getMinutes().toString().padStart(2, '0');
            }, 500);
        }
    </script>
</body>
</html>